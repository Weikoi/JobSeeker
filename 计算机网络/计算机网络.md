## 计算机网络基础
（参考自顶向下的计算机网络/图解http/http权威指南）

---
---
### 网络基础
#### 计算机网络中的常见概念

1. 何为计算机网络协议？

协议，即规则的集合。计算机的网络协议指的是为了网络中的数据交换而建立的规则与标准；特点是控制对等实体之间的通信，是水平的。低层的协议对高层是透明的。

2. 何为接口？

接口指的是相邻两层之间信息交换的连接点。

3. 何为服务？

服务指的是下层为相邻上层提供的功能调用，是垂直的关系。



#### 面向连接和无连接服务的区别？

* 面向连接服务中，通信的双方必须先建立连接，分配相应的资源，用以保证通信可以顺利进行，传输结束后再回收相关资源。是一种可靠的服务。

* 无连接服务中，通信前双方不需要先建立连接，需要发送数据时直接发送，把带有目的地址的数据包直接传送到线路上，由系统选定路线进行传输，只会尽最大努力交付，是一种不可靠的服务。

#### 可靠服务和不可靠服务的区别？

* 可靠服务指的是网络中有纠错、检错、应答等机制，可以保证数据正确可靠地传送到目的地；

* 不可靠服务指网络尽量正确的传送，但是不能保证数据可以正确可靠地到达目的地。

#### OSI传输协议以及对应每一层的功能与传输单位？

1. 物理层

功能是在物理硬件上为设备端透明地传输原始比特流，传输单位是比特；

2. 数据链路层

功能是将网络层的IP数据包组装成数据帧，传输单位是帧；

3. 网络层

功能是将网络分组从源端传送到目的端，为分组进行路由的选择。传输单位是IP数据报；

4. 传输层

功能是负责主机两个进程间的通信，传输单位是报文段（TCP）或者用户数据报（UDP）；

5. 会话层

负责处理不同主机上各进程之间的会话。

6. 表示层

处理两个通讯系统之间交换信息的表示方式。（数据压缩、加密和解密等）

7. 应用层

为应用提供访问OSI的手段

#### TCP/IP 协议

1. 网络接口层 或者叫 链路层（OSI 下两层）

2. 网际层 或者叫 网络层

3. 传输层

4. 应用层（OSI 上三层）

---
---

### 应用层协议
### HTTP

#### HTTP协议的工作流程（我打开一个网页都发生了哪些过程）？

1. 浏览器分析用户请求的URL地址
2. 浏览器向DNS服务器请求URL所对应的域名服务器IP地址
3. DNS解析出IP地址
4. 浏览器和对应服务器建立TCP连接
5. 浏览器发出get请求
6. 服务器通过HTTP响应将相应的文件（Html、其他资源等）发送给浏览器
7. TCP连接释放
8. 浏览器解析收到的文件，将web页面显示给用户

#### HTTP协议的特点？

HTTP是无状态的，同一个客户对同一个服务器发送相同的HTTP请求，服务器的响应是完全相同的。这样简化了服务器的设计，提高了服务器支持的并发请求数目。

HTTP基于TCP协议，保证数据的可靠传输。但是本身是无连接的，也就是说在双方交换报文前不需要事先建立连接。1.1以后默认使用流水线的持久连接。所有引用对象共计一个RTT时延。


#### HTTP首部通常包含哪些内容？

1. 请求报文：



2. 响应报文


#### HTTP缓存机制？

Cookie是一个存储在用户主机中的文本文件，里面包含一串识别码，用于服务器识别用户，根据识别码就可以查询到用户的浏览记录，可以据此执行一些个性化推荐。

#### HTTP常见的响应状态码有哪些？分别什么含义？

##### 1xx 信息性状态码

100 continue

2XX 成功

##### 200 OK 
 
204 No Content 

206 Partial Content 

##### 3XX 重定向 

301 Moved Permanently 

302 Found  

303 See Other 

304 Not Modified  

307 Temporary Redirect 

##### 4XX 客户端错误 

400 Bad Request 

401 Unauthorized 

403 Forbidden 

404 Not Found 

##### 5XX 服务器错误  

500 Internal Server Error  

503 Service Unavailable 


#### HTTP和HTTPS的关系？



#### DNS协议是什么？

全称 Domain Name System， 是用于将人记忆的主机名（网址主页URL）转换为机器处理的IP地址的协议。

采用 C/S 模型，协议基于UDP， 一般使用53号端口。

#### 域名解析过程是什么样的？

客户端需要解析域名时，通过DNS客户端构造一个DNS请求报文，以UDP数据报发往本地的域名服务器。

域名解析可以分为递归查询 与 递归、迭代结合查询，但是由于递归查询会造成顶层服务器负载过重，因此一般不使用。

过程为;

1. 客户机向本地域名服务器发出DNS请求报文；
2. 本地域名服务器收到请求后，先查询本地缓存，如果没有再自己以DNS客户的身份向根域名服务器发送请求；
3. 根域名服务器收到请求，判断属于什么哪个顶级域，将对应的顶级服务器IP返还给本地域名服务器。
4. 本地域名服务器接着向顶级域名服务器发送查询请求，顶级域名服务器收到请求后，判断属于哪个授权域，将对应的授权域名服务器IP返还给本地域名服务器
5. 本地域名服务器向授权域名服务器发送查询请求
6. 授权域名服务器返还查询结果
7. 本地域名服务器将结果缓存到本地，然后同时将结果返回给客户机。


#### 关于域名

互联网层次树状结构的方式给服务器和路由器命名，任何一个连接到互联网的主机或者路由器都有一个唯一的层次结构名，称为域名。

域名可以被进一步划分为子域名，他们之间通过 . 分隔，处于最右边的为顶级域名，从右往左依次为二级、三级。

例如 www.baidu.com 中 com 为顶级域名，baidu为二级域名，www为三级域名。

整个域名系统实质是一个联机的分布式数据库系统。域名到IP地址的解析都是通过运行在域名服务器上的程序完成的。

#### 


---
---
### 传输层协议
### TCP

#### TCP三次握手和四次挥手？

三次握手：
<div align="center"> <img src="./pic/三次握手.jpg"/> </div>

四次挥手：
<div align="center"> <img src="./pic/四次挥手.jpg"/> </div>

#### 为什么TIME_WAIT状态还需要等2MSL后才能返回到CLOSED状态？

TIME_WAIT状态由两个存在的理由。

（1）为了可靠地实现TCP全双工链接的终止。

这是因为虽然双方都同意关闭连接了，而且握手的4个报文也都协调和发送完毕，按理可以直接回到CLOSED状态（就好比从SYN_SEND状态到ESTABLISH状态那样）；但是因为我们必须要假想网络是不可靠的，你无法保证你最后发送的ACK报文会一定被对方收到，因此对方处于LAST_ACK状态下的SOCKET可能会因为超时未收到ACK报文，而重发FIN报文，所以这个TIME_WAIT状态的作用就是用来重发可能丢失的ACK报文。

（2）为了允许老的重复的报文在网络中完全消逝。

假设在12.106.32.254的1500端口和206.168.1.112.219的21端口之间有一个TCP连接。我们关闭这个链接，过一段时间后在相同的IP地址和端口建立另一个连接。后一个链接成为前一个的化身。因为它们的IP地址和端口号都相同。TCP必须防止来自某一个连接的老的重复分组在连接已经终止后再现，从而被误解成属于同一链接的某一个某一个新的化身。为做到这一点，TCP将不给处于TIME_WAIT状态的链接发起新的化身。既然 TIME_WAIT状态的持续时间是MSL的2倍，这就足以让某个方向上的分组最多存活msl秒即被丢弃，另一个方向上的应答最多存活msl秒也被丢弃。 通过实施这个规则，我们就能保证每成功建立一个TCP连接时。来自该链接先前化身的重复分组都已经在网络中消逝了。

为什么上图中的A在TIME-WAIT状态必须等待2MSL时间呢？ 

第一，为了保证A发送的最后一个ACK报文能够到达B。这个ACK报文段有可能丢失，因而使处在LAST-ACK状态的B收不到对已发送的FIN+ACK报文段的确认。B会超时重传这个FIN+ACK报文段，而A就能在2MSL时间内收到这个重传的FIN+ACK报文段。如果A在TIME-WAIT状态不等待一段时间，而是在发送完ACK报文段后就立即释放连接，就无法收到B重传的FIN+ACK报文段，因而也不会再发送一次确认报文段。这样，B就无法按照正常的步骤进入CLOSED状态。 

第二，A在发送完ACK报文段后，再经过2MSL时间，就可以使本连接持续的时间所产生的所有报文段都从网络中消失。这样就可以使下一个新的连接中不会出现这种旧的连接请求的报文段。

#### 基于P2P的迅雷为什么要基于UDP，而不是TCP？

1）开销
2）穿透
3）速度

#### UDP和TCP可不可以共用一个网络端口？

---

### 网络层协议

#### ARP协议是干嘛的，工作在哪一层？

#### IP地址的分类？

#### IP地址有哪些常见的扩展方法？

#### IPv6?

#### RIP 和 OSPF 协议都是干嘛的？

---

### 链路层

#### 链路层的流量控制机制实现？

#### 
